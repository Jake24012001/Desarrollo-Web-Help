<div class="container">
  <!-- Buscador -->
  <div class="d-flex align-items-center gap-2 my-3">
    <input type="text" class="form-control form-control-sm w-25" [placeholder]="placeholderText"
      [(ngModel)]="terminoBusqueda" (input)="filtrarDatos()" />
    <button class="btn btn-dark btn-sm" (click)="limpiarBusqueda()">Limpiar</button>
  </div>

  <!--Tabla de tickets pendientes -->
  <div class="glass-card p-3 rounded shadow-sm mb-4">
    <h5 class="fw-bold mb-3">ğŸ“Œ Tickets Pendientes</h5>
    <table class="table table-hover table-bordered align-middle text-center">
      <thead class="table-dark">
        <tr>
          <th>Fecha de CreaciÃ³n</th>
          <th>title</th>
          <th>DescripciÃ³n</th>
          <th>Asignado a</th>
          <th>Equipo Afectado</th>
          <th>Creado por</th>
          <th>Prioridad</th>
          <th>Tiempo Transcurrido</th>
          <th>Acciones</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of datosFiltradosPendientes; let i = index">
          <td>
            <span *ngIf="item.fecha_creacion">
              {{ item.fecha_creacion | date:'short' }}
            </span>
            <span *ngIf="!item.fecha_creacion">â€”</span>
          </td>
          <td>{{ item.title || 'â€”' }}</td>
          <td>{{ item.descripcion || 'â€”' }}</td>
          <td>{{ item.usuario_asignado?.nombre || 'â€”' }}</td>
          <td>{{ item.equipoAfectado?.product?.name || 'â€”' }}</td>
          <td>{{ item.usuario_creador?.nombre || 'â€”' }}</td>
          <td>{{ item.priority?.nombre || 'â€”' }}</td>
          <td>
            <span *ngIf="item.tiempoRestante">{{ item.tiempoRestante }}</span>
            <span *ngIf="!item.tiempoRestante">â€”</span>
          </td>
          <td>
            <div class="d-flex justify-content-center gap-2">
              <button class="btn btn-outline-primary btn-sm" (click)="modificarPeticion(item)">Editar</button>
              <button class="btn btn-outline-danger btn-sm" (click)="borrarPeticion(i, 'resuelto')">Eliminar</button>
              <button class="btn btn-outline-success btn-sm" (click)="marcarComoResuelta(item)"> Resuelta</button>
            </div>
          </td>
          <td>
            <span [ngClass]="getClaseEstado(item.status?.nombre || '')" class="estado-label">
              {{ item.status?.nombre }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="glass-card p-3 rounded shadow-sm">
    <h5 class="fw-bold mb-3">âœ… Tickets Resueltos</h5>
    <table class="table table-hover table-bordered align-middle text-center">
      <thead class="table-success">
        <tr>
          <th>Fecha de CreaciÃ³n</th>
          <th>DescripciÃ³n</th>
          <th>Asignado a</th>
          <th>Equipo Afectado</th>
          <th>Creado por</th>
          <th>Prioridad</th>
          <th>Tiempo Transcurrido</th>
          <th>Eliminar</th> <!-- Nueva columna -->
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of datosResueltos; let i = index">
          <td>
            <span *ngIf="item.fecha_creacion">
              {{ item.fecha_creacion | date:'short' }}
            </span>
            <span *ngIf="!item.fecha_creacion">â€”</span>
          </td>
          <td>{{ item.descripcion || 'â€”' }}</td>
          <td>{{ item.usuario_asignado?.nombre || 'â€”' }}</td>
          <td>{{ item.equipoAfectado?.product?.name || 'â€”' }}</td>
          <td>{{ item.usuario_creador?.nombre || 'â€”' }}</td>
          <td>{{ item.priority?.nombre || 'â€”' }}</td>
          <td>
            <span *ngIf="item.fecha_cierre">
              {{ calcularTiempoRestante(item.fecha_cierre) }}
            </span>
            <span *ngIf="!item.fecha_cierre">â€”</span>
          </td>
          <td>
            <button class="btn btn-sm btn-danger" (click)="borrarPeticion(i, 'resuelto')">
              ğŸ—‘ï¸
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!--Botones principales -->
  <div class="d-flex gap-3 justify-content-end my-3">
    <button class="btn btn-success btn-sm" (click)="crearPeticion()">
      <i class="bi bi-plus-circle"></i> CREAR
    </button>
    <button class="btn btn-warning btn-sm" [disabled]="true">
      <i class="bi bi-pencil"></i> MODIFICAR
    </button>
  </div>
</div>